<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>The Fall of GameLoop | Bari Plux</title>
    <meta name="description" content="Why recurring lag, crashes, OpenGL failures, and input bugs signal the end of GameLoop as a viable emulator for competitive play.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800&family=Playfair+Display:wght@400;500;600;700&family=Oxanium:wght@400;600;700&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/all-styles.css">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://i.postimg.cc/65cjsvfQ/imglogo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://i.postimg.cc/65cjsvfQ/imglogo.png">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="The Fall of GameLoop | Bari Plux">
    <meta property="og:description" content="Lag spikes, crashes, OpenGL renderer failures, and mouse lock bugs‚Äîwhy these issues mark the end of GameLoop.">
    <meta property="og:type" content="article">
    <meta property="og:image" content="https://yt3.googleusercontent.com/RPW5Z_kcoEu0ES_VpL4-7ZqI4eI1OQfuVL-DbuCYWmRhXono9hA5NOCSGGMDLzJqNcHUlhOg=s160-c-k-c0x00ffffff-no-rj">

    <style>
        :root {
            --bg-1: #0f1115;
            --bg-2: #15171b;
            --glass-bg: rgba(255,255,255,0.06);
            --glass-strong: rgba(255,255,255,0.08);
            --glass-accent: rgba(108,99,255,0.12);
            --accent: #6C63FF;
            --accent-2: #00BFA6;
            --text: #e8eef8;
            --muted: rgba(232,238,248,0.65);
            --radius-lg: 20px;
            --radius: 12px;
            --transition: 300ms cubic-bezier(.2,.9,.2,1);
            --glass-border: rgba(255,255,255,0.08);
            --glass-inner-shadow: rgba(0,0,0,0.35);
            --shadow: 0 8px 30px rgba(0,0,0,0.35);
            --shadow-hover: 0 24px 50px rgba(0,0,0,0.45);
        }
        /* Scroll Progress Bar */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--accent-2));
            z-index: 10001;
            transition: width 0.1s ease-out;
            box-shadow: 0 0 10px var(--accent);
        }
        [data-theme="light"]{
            --bg-1: #f6f8fb;
            --bg-2: #eef2f7;
            --glass-bg: rgba(255,255,255,0.85);
            --glass-strong: rgba(255,255,255,0.95);
            --glass-accent: rgba(108,99,255,0.08);
            --accent: #5748E8;
            --accent-2: #07bfa0;
            --text: #111827;
            --muted: rgba(17,24,39,0.6);
            --glass-border: rgba(0,0,0,0.04);
            --glass-inner-shadow: rgba(255,255,255,0.6);
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        html, body { height:100%; scroll-behavior:smooth; }
        body {
            font-family: 'Poppins', sans-serif;
            background:
                radial-gradient(800px 400px at 10% 20%, rgba(108,99,255,0.08), transparent 10%),
                radial-gradient(600px 300px at 90% 80%, rgba(0,191,166,0.06), transparent 12%),
                linear-gradient(180deg,var(--bg-1),var(--bg-2));
            color: var(--text);
            line-height: 1.8;
            overflow-x: hidden;
            transition: color var(--transition);
            background-attachment: fixed;
            position: relative;
        }
        h1, h2, h3 { font-family:'Playfair Display', serif; font-weight:700; margin-bottom:20px; }
        h1 { font-size:3rem; margin-bottom:20px; line-height:1.2; color:var(--text); letter-spacing:-0.5px; }
        h2 { font-size:2rem; margin-top:50px; color:var(--accent); position:relative; padding-bottom:15px; }
        h2::after { content:''; position:absolute; bottom:0; left:0; width:60px; height:3px; background:linear-gradient(to right,var(--accent),var(--accent-2)); border-radius:50px; }
        h3 { font-size:1.5rem; margin-top:35px; color:var(--accent-2); }
        p { margin-bottom:25px; font-size:1.15rem; line-height:1.8; opacity:0.9; }
        a { color:var(--accent); text-decoration:none; transition:var(--transition); }
        a:hover { color:var(--accent-2); text-decoration:underline; }

        /* Header */
        .header{
            position:fixed; top:0; left:0; width:100%; z-index:1000;
            margin:12px auto; padding:10px 18px; border-radius:28px;
            display:flex; align-items:center; justify-content:space-between; gap:16px;
            box-shadow:0 6px 22px rgba(0,0,0,0.35);
            backdrop-filter: blur(20px) saturate(150%);
            -webkit-backdrop-filter: blur(20px) saturate(150%);
            max-width:1400px; left:50%; transform:translateX(-50%);
            transition:var(--transition);
            background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
            border:1px solid var(--glass-border);
        }
        .header.scrolled { margin:6px auto; box-shadow:0 8px 30px rgba(0,0,0,0.45); }
        .header .left{display:flex;align-items:center;gap:14px}
        .logo-img{width:54px;height:54px;border-radius:50%;object-fit:cover;border:2px solid rgba(255,255,255,0.12)}
        .logo-text{font-weight:800;font-size:1.2rem;background:linear-gradient(90deg,var(--accent),var(--accent-2));-webkit-background-clip:text;background-clip:text;color:transparent}

        /* Nav */
        .nav-links { display:flex; gap:25px; }
        .nav-link { position:relative; font-weight:500; padding:10px 0; transition:var(--transition); color:var(--text); }
        .nav-link::before{
            content:''; position:absolute; bottom:0; left:0; width:0; height:3px;
            background:linear-gradient(to right,var(--accent),var(--accent-2));
            transition:var(--transition); border-radius:3px;
        }
        .nav-link:hover, .nav-link.active{ color:var(--accent); }
        .nav-link:hover::before, .nav-link.active::before{ width:100%; }

        /* Search Container */
        .search-container { position: relative; }
        .collapsible-search { display: flex; align-items: center; gap: 8px; padding: 8px 14px; border-radius: 25px; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); transition: all 0.3s; }
        .collapsible-search:focus-within { border-color: var(--accent); box-shadow: 0 0 15px rgba(108,99,255,0.2); }
        .search-icon { color: rgba(232,238,248,0.5); }
        .search-input { background: transparent; border: none; color: var(--text); font-size: 0.85rem; width: 150px; outline: none; }
        .search-input::placeholder { color: rgba(232,238,248,0.4); }
        .login-btn-header { display: flex; align-items: center; gap: 8px; padding: 10px 20px; background: var(--glass-bg); border: 1px solid var(--glass-border); color: var(--text); border-radius: 25px; text-decoration: none; font-weight: 600; font-size: 0.9rem; transition: all 0.3s ease; }
        .login-btn-header:hover { background: rgba(255,255,255,0.1); transform: translateY(-2px); color: var(--text); }

        /* Theme toggle */
        .theme-toggle{ width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;background:rgba(255,255,255,0.05);border:1px solid var(--glass-border);transition:all 0.3s;font-size:1.1rem; }
        .theme-toggle:hover { background: rgba(108,99,255,0.2); transform: scale(1.1); }
        .theme-toggle .moon-icon { display: block; font-size: 1.2rem; }
        .theme-toggle .sun-icon { display: none; font-size: 1.2rem; }
        [data-theme="light"] .theme-toggle .moon-icon { display: none; }
        [data-theme="light"] .theme-toggle .sun-icon { display: block; }

        /* Layout */
        .container{ max-width:800px; margin:120px auto 80px; position:relative; z-index:1; padding:0 20px; }
        .article-header{ margin-bottom:40px; text-align:center; padding:40px 0; border-bottom:1px solid var(--glass-border); }
        .article-category {
            display: inline-block;
            background: linear-gradient(to right, var(--accent), var(--accent-2));
            color: white;
            padding: 8px 20px;
            border-radius: var(--radius-round);
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .tag-list{ display:flex;gap:10px; flex-wrap:wrap; justify-content:center; margin:14px 0 6px; }
        .tag{ font-size:.8rem; padding:6px 12px; border:1px solid var(--glass-border); border-radius:999px; background:var(--glass-bg); color:var(--muted); }

        .article-meta{ display:flex; justify-content:center; gap:25px; margin-bottom:30px; flex-wrap:wrap; color:var(--muted); font-size:.95rem; }
        .meta-item{ display:flex; align-items:center; gap:8px; }
        .article-lead{ font-size:1.4rem; line-height:1.6; color:var(--muted); margin-bottom:30px; font-weight:400; max-width:700px; margin-left:auto; margin-right:auto; }

        .article-content{ padding:40px 0; }
        .article-section{ margin-bottom:50px; }
        .highlight-box{ background:var(--glass-bg); border-left:4px solid var(--accent); padding:25px; margin:30px 0; border-radius:0 var(--radius) var(--radius) 0; backdrop-filter:blur(10px); }
        .highlight-box p{ margin-bottom:0; font-style:italic; font-size:1.2rem; line-height:1.6; }

        .back-btn{ display:inline-flex; align-items:center; gap:12px; margin-bottom:30px; color:white; background:linear-gradient(135deg, rgba(108,99,255,0.8), rgba(0,191,166,0.8)); padding:12px 25px; border-radius:50px; transition:var(--transition); font-weight:600; border:none; cursor:pointer; position:relative; overflow:hidden; backdrop-filter: blur(20px) saturate(180%); -webkit-backdrop-filter: blur(20px) saturate(180%); border:1px solid rgba(255,255,255,0.2); box-shadow:0 8px 32px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.3), inset 0 -1px 0 rgba(0,0,0,0.2); }
        .back-btn::before{ content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); transition:left .7s; }
        .back-btn:hover::before{ left:100%; }
        .back-btn:hover{ background:linear-gradient(135deg, rgba(108,99,255,0.9), rgba(0,191,166,0.9)); transform:translateY(-3px); box-shadow:0 12px 40px rgba(107,255,223,0.3), inset 0 1px 0 rgba(255,255,255,0.4), inset 0 -1px 0 rgba(0,0,0,0.3); border-color:rgba(255,255,255,0.3); text-decoration:none; color:white; }

        /* Scroll-to-top */
        .scroll-top{ position:fixed; bottom:26px; right:26px; width:52px; height:52px; border-radius:999px; display:flex; align-items:center; justify-content:center; background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:white; box-shadow:0 18px 40px rgba(0,0,0,0.45); cursor:pointer; transform:translateY(20px); opacity:0; visibility:hidden; transition:all var(--transition); z-index:100; border:none; }
        .scroll-top.visible{ transform:translateY(0); opacity:1; visibility:visible; }

        /* Footer */
        .article-footer{ margin-top:60px; padding-top:40px; border-top:1px solid var(--glass-border); text-align:center; }
        .share-section{ margin:30px 0; }
        .share-title{ margin-bottom:15px; color:var(--muted); font-size:1rem; }
        .share-buttons{ display:flex; justify-content:center; gap:15px; }
        .share-btn{ width:45px; height:45px; border-radius:50%; background:var(--glass-bg); border:1px solid var(--glass-border); display:flex; align-items:center; justify-content:center; color:var(--text); transition:var(--transition); backdrop-filter:blur(10px); }
        .share-btn:hover{ background:var(--accent); color:white; transform:translateY(-3px); }

        /* Scrollbar */
        ::-webkit-scrollbar{ width:12px; }
        ::-webkit-scrollbar-track{ background:var(--bg-2); border-radius:10px; }
        ::-webkit-scrollbar-thumb{ background:linear-gradient(to bottom,var(--accent),var(--accent-2)); border-radius:50px; border:2px solid var(--bg-2); }

        /* Responsive */
        @media (max-width:768px){
            .container{ margin:100px auto 60px; }
            .nav-links{ display:none; }
            .article-content{ padding:30px 0; }
            h1{ font-size:2.2rem; }
            h2{ font-size:1.7rem; margin-top:40px; }
            h3{ font-size:1.3rem; margin-top:30px; }
            p{ font-size:1.05rem; }
            .article-meta{ gap:15px; }
            .article-lead{ font-size:1.2rem; }
            .header{ padding:10px 15px; margin:6px auto; width:calc(100% - 12px); }
        }
        @media (max-width:576px){
            .container{ margin:90px auto 40px; }
            h1{ font-size:1.8rem; }
            h2{ font-size:1.5rem; }
            h3{ font-size:1.2rem; }
            p{ font-size:1rem; }
            .article-meta{ flex-direction:column; align-items:center; gap:10px; }
            .article-lead{ font-size:1.1rem; }
            .highlight-box{ padding:20px; }
            .highlight-box p{ font-size:1.1rem; }
        }
        
        /* User Menu Dropdown */
        .user-menu-container { position: relative; }
        .user-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            min-width: 250px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 12px;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.95) translateY(-10px);
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 1000;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
        }
        .user-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: scale(1) translateY(0);
        }
        .dropdown-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        .user-avatar-small {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 700;
            color: white;
            flex-shrink: 0;
        }
        .user-name-dropdown {
            font-weight: 600;
            color: var(--light);
            font-size: 0.9rem;
        }
        .user-email-dropdown {
            color: var(--gray);
            font-size: 0.8rem;
            margin-top: 2px;
        }
        .dropdown-divider {
            height: 1px;
            background: var(--glass-border);
            margin: 8px 0;
            opacity: 0.5;
        }
        .dropdown-actions {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .dropdown-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            padding: 10px 12px;
            background: transparent;
            border: 1px solid transparent;
            color: var(--light);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: var(--transition);
        }
        .dropdown-btn:hover {
            background: rgba(108, 99, 255, 0.1);
            border-color: rgba(108, 99, 255, 0.3);
            transform: translateX(4px);
        }
        .dropdown-btn i {
            width: 18px;
            text-align: center;
            color: var(--accent);
        }
    </style>
</head>
<body>
    <!-- Security: Disable right-click and keyboard shortcuts -->
    <script>
        document.addEventListener('contextmenu', function(e) { e.preventDefault(); }, false);
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.key === 's' || e.key === 'S')) || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'i' || e.key === 'C' || e.key === 'c'))) {
                e.preventDefault();
            }
        }, false);
        document.ondragstart = function() { return false; };
    </script>
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Header -->
    <header class="header glass">
        <div class="left">
            <a href="index.html" class="logo" style="display:flex;align-items:center;gap:12px;text-decoration:none">
                <img class="logo-img" src="https://yt3.googleusercontent.com/RPW5Z_kcoEu0ES_VpL4-7ZqI4eI1OQfuVL-DbuCYWmRhXono9hA5NOCSGGMDLzJqNcHUlhOg=s160-c-k-c0x00ffffff-no-rj" alt="Bari Plux">
                <span class="logo-text">Bari Plux</span>
            </a>
        </div>

        <nav class="nav">
            <ul class="nav-links">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="index.html#downloads" class="nav-link">Downloads</a></li>
                <li><a href="index.html#videos" class="nav-link">Videos</a></li>
                <li><a href="mapspubg.html" class="nav-link">Maps</a></li>
                <li><a href="weaponorg.html" class="nav-link">Weapons</a></li>
                <li><a href="news.html" class="nav-link">News</a></li>
                <li><a href="updates.html" class="nav-link">Updates</a></li>
            </ul>
        </nav>

        <div style="display:flex;align-items:center;gap:12px">
            <div id="theme-toggle" class="theme-toggle" title="Toggle Theme">
                <span class="moon-icon">üåô</span>
                <span class="sun-icon">‚òÄÔ∏è</span>
            </div>

            <div class="user-menu-container">
                <button id="loginBtnHeader" class="login-btn-header" title="Login">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Login</span>
                </button>
                <div id="userDropdown" class="user-dropdown glass">
                    <div class="dropdown-header">
                        <div class="user-avatar-small" id="userAvatar">U</div>
                        <div>
                            <div class="user-name-dropdown" id="userName">User</div>
                            <div class="user-email-dropdown" id="userEmail">user@example.com</div>
                        </div>
                    </div>
                    <div class="dropdown-divider"></div>
                    <div class="dropdown-actions">
                        <button type="button" id="viewProfileBtn" class="dropdown-btn">
                            <i class="fas fa-user-circle"></i>
                            <span>View Profile</span>
                        </button>
                        <button type="button" id="logoutBtn" class="dropdown-btn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Article -->
    <div class="container">
        <a href="index" class="back-btn">
            <i class="fas fa-arrow-left"></i>
            Back to Home
        </a>

        <article>
            <header class="article-header">
                <span class="article-category">Technology & Gaming</span>
                <h1>The Fall of GameLoop: When an Emulator Reaches Its End</h1>

                <div class="article-meta">
                    <span class="meta-item"><i class="far fa-calendar-alt"></i> October 30, 2025</span>
                    <span class="meta-item"><i class="far fa-clock"></i> 6 min read</span>
                </div>

                <p class="article-lead">
                    Once celebrated for smooth Android gaming on PC, <strong>GameLoop</strong> now struggles with
                    <em>lag spikes</em>, <em>random crashes</em>, <em>frozen frames</em>, and <em>severe FPS drops</em>.
                    For many players, these recurring failures don‚Äôt feel like temporary bugs anymore ‚Äî they read like signs of an ending.
                </p>
            </header>

            <div class="article-content">
                <div class="article-section">
                    <h2>From Emulator to Error Machine</h2>
                    <p><strong>OpenGL rendering breaks without warning.</strong> Some sessions won‚Äôt even start. On other days, the app opens but refuses to <strong>lock the mouse</strong>, killing aim and tracking. Mid-match, the client <strong>crashes to desktop</strong> or the screen <strong>freezes</strong> while audio keeps playing. And sometimes, <strong>GameLoop simply doesn‚Äôt launch</strong> at all.</p>
                    <div class="highlight-box">
                        <p><strong>These failures erode trust</strong>: when the tool meant to guarantee control behaves unpredictably, it‚Äôs more than a bug ‚Äî it‚Äôs a purpose breakdown.</p>
                    </div>
                </div>

                <div class="article-section">
                    <h2>A System Buckling Under Its Own Complexity</h2>
                    <p>Years of patches, performance switches, and compatibility layers have produced <strong>layers of instability</strong>. Each quick fix risks breaking a different subsystem ‚Äî shader compilation, driver hooks, input capture, or render pipelines. The emulator‚Äôs optimization logic is caught in a paradox: to support more games and hardware, it adds complexity that <em>undercuts stability</em>.</p>
                    <p>Symptoms players report most: <em>stutter on map load</em>, <em>FPS sawtooth in fights</em>, <em>cursor desync</em>, <em>OpenGL context loss</em>, and <em>sporadic window focus issues</em>.</p>
                </div>

                <div class="article-section">
                    <h2>When the Game Stops Being About the Game</h2>
                    <p>The experience shifts from play to maintenance. Users spend sessions <strong>clearing cache</strong>, <strong>resetting services</strong>, toggling renderers, and swapping driver branches. The community splits into ‚Äútweakers‚Äù and ‚Äúquitters,‚Äù while true newcomers rarely stay. The emulator becomes <strong>a symbol of burnout</strong> ‚Äî technical and emotional.</p>
                </div>

                <div class="article-section">
                    <h2>The Illusion of Continuity</h2>
                    <p>Even as issues pile up, habit keeps people reinstalling, downgrading, and hunting for secret scripts. But each crash whispers the same message: <strong>‚ÄúIt‚Äôs over.‚Äù</strong></p>
                    <div class="highlight-box">
                        <p>In trying to emulate progress, GameLoop has <strong>emulated its own destruction</strong>. What remains is a loop of hope, tweaks, and fresh disappointments.</p>
                    </div>
                </div>

                <div class="article-section">
                    <h2>What ‚ÄúEnd‚Äù Really Means Here</h2>
                    <p>The end isn‚Äôt a single shutdown screen. It‚Äôs the moment players <em>stop believing</em> that the next tweak will finally fix it. For competitive titles, reliability is a feature ‚Äî and when reliability dies, the platform follows.</p>
                    <h3>What to Highlight in the Layout</h3>
                    <ul style="margin-left:1.2rem; line-height:1.9;">
                        <li><strong>The Fall of GameLoop: When an Emulator Reaches Its End</strong></li>
                        <li><strong>OpenGL rendering breaks without warning.</strong></li>
                        <li><strong>The mouse fails to lock.</strong></li>
                        <li><strong>Game sessions crash mid-match.</strong></li>
                        <li><strong>Layers of instability</strong></li>
                        <li><strong>A symbol of burnout</strong></li>
                        <li><strong>‚ÄúIt‚Äôs over.‚Äù</strong></li>
                        <li><strong>Emulated its own destruction.</strong></li>
                    </ul>
                </div>
            </div>

            <footer class="article-footer">
                <div class="share-section">
                    <div class="share-title">Share this article</div>
                    <div class="share-buttons">
                        <a href="#" class="share-btn" aria-label="Share on X/Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="share-btn" aria-label="Share on Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="share-btn" aria-label="Share on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" class="share-btn" aria-label="Share on Telegram"><i class="fab fa-telegram"></i></a>
                    </div>
                </div>

                <a href="index" class="back-btn">
                    <i class="fas fa-arrow-left"></i>
                    Back to Home
                </a>
            </footer>
        </article>
    </div>

    <!-- Scroll to top -->
    <div id="scroll-top" class="scroll-top" title="Back to top"><i class="fas fa-arrow-up"></i></div>

    <script>
        // Theme Toggle
        function setupThemeToggle(){
            const themeToggle = document.getElementById('theme-toggle');
            if (!themeToggle) return;

            const stored = localStorage.getItem('theme') ||
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', stored);

            themeToggle.addEventListener('click', ()=>{
                const current = document.documentElement.getAttribute('data-theme');
                const next = current === 'light' ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', next);
                localStorage.setItem('theme', next);
            });
        }

        // Header Scroll Effect
        const header = document.querySelector('.header');
        if (header) {
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) header.classList.add('scrolled');
                else header.classList.remove('scrolled');
            });
        }

        // Scroll to top
        function setupScrollTop(){
            const btn = document.getElementById('scroll-top');
            if (!btn) return;

            window.addEventListener('scroll', ()=>{
                if (window.pageYOffset > 350) btn.classList.add('visible');
                else btn.classList.remove('visible');
            });

            btn.addEventListener('click', ()=>{
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setupThemeToggle();
            setupScrollTop();
        });
    </script>

    <!-- Scroll Progress Bar -->
    <script>
        const scrollProgress = document.getElementById('scrollProgress');
        if (scrollProgress) {
            window.addEventListener('scroll', () => {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = (scrollTop / docHeight) * 100;
                scrollProgress.style.width = scrollPercent + '%';
            }, { passive: true });
        }
    </script>

    <!-- Login Status - Update Header Button -->
    <script>
    function updateLoginButton() {
        const loginBtn = document.getElementById('loginBtnHeader');
        const dropdown = document.getElementById('userDropdown');
        if (!loginBtn || !dropdown) return;
        
        const storedUser = localStorage.getItem('bariplux_user');
        if (storedUser) {
            try {
                const user = JSON.parse(storedUser);
                const userName = user.name || user.email.split('@')[0];
                const userEmail = user.email || '';
                const initial = userName.charAt(0).toUpperCase();
                
                loginBtn.innerHTML = '<span style="display:flex;align-items:center;gap:8px;"><span style="width:28px;height:28px;background:linear-gradient(135deg,var(--accent),var(--accent-2));border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:white;">' + initial + '</span><span style="font-size:0.9rem;">' + userName.substring(0, 12) + (userName.length > 12 ? '...' : '') + '</span></span>';
                loginBtn.style.cursor = 'pointer';
                loginBtn.onclick = function(e) { e.preventDefault(); e.stopPropagation(); toggleDropdown(); };
                
                document.getElementById('userAvatar').innerHTML = initial;
                document.getElementById('userName').textContent = userName;
                document.getElementById('userEmail').textContent = userEmail;
                
                document.getElementById('viewProfileBtn').onclick = function(e) { e.preventDefault(); e.stopPropagation(); toggleDropdown(); };
                document.getElementById('logoutBtn').onclick = function() {
                    if (confirm('Logout from Bari Plux?')) {
                        localStorage.removeItem('bariplux_user');
                        localStorage.removeItem('bariplux_login_token');
                        location.reload();
                    }
                };
            } catch (e) {
                console.error('Error parsing user:', e);
            }
        } else {
            loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i><span>Login</span>';
            loginBtn.href = 'login.html';
            loginBtn.onclick = null;
            dropdown.classList.remove('active');
        }
    }

    function toggleDropdown() {
        const dropdown = document.getElementById('userDropdown');
        dropdown.classList.toggle('active');
    }

    document.addEventListener('click', function(e) {
        const dropdown = document.getElementById('userDropdown');
        const container = document.querySelector('.user-menu-container');
        
        if (container && !container.contains(e.target)) {
            dropdown.classList.remove('active');
        }
    });
    
    updateLoginButton();
    setTimeout(updateLoginButton, 500);
    setTimeout(updateLoginButton, 1000);
    </script>
</body>
</html>
